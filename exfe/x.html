<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>EXFE</title>
  <meta name="description" content="">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>

  <style>
    article, aside, details, figcaption, figure, footer, header, hgroup, nav, section { display: block; }
    audio, canvas, video { display: inline-block; *display: inline; *zoom: 1; }
    audio:not([controls]) { display: none; }
    [hidden] { display: none; }

    html { font-size: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }
    body { margin: 0; font-size: 13px; line-height: 1.231; }
    h1, h2, h3, h4, h5, h6, p { margin: 0; padding: 0;}
      iframe {display: none;}
    ul, ol { margin: 0; padding: 0; }
    nav ul, nav ol { list-style: none; list-style-image: none; margin: 0; padding: 0; }
    img { border: 0; -ms-interpolation-mode: bicubic; vertical-align: middle; }

    .hidden { display: none !important; visibility: hidden; }
    .clearfix:before, .clearfix:after { content: ""; display: table; }
    .clearfix:after { clear: both; }
    .clearfix { *zoom: 1; }

      body {background-color: #F4F4F4}
    #container {
      /*border: 1px solid #555;*/
      max-width: 320px;
      height: 100%;
      margin: 0 auto;
      font-family: Helvetica,HelveticaNeue,"Helvetica Neue",Arial,sans-serif;
      /*padding: 0 10px;*/
      background: url(img/bkg.png) no-repeat #F4F4F4;
    }

    #container > header {
      height: 44px;
      padding: 0 10px;
    }

    nav a {
      display: inline-block;
      text-decoration: none;
      text-indent: -9999px;
      margin-top: 5px;
    }
    #main {
      background: url(img/profile_bkg.png) no-repeat rgba(244, 244, 244, 0.6);
    }
    #cross {
      padding: 0 10px;
    }
    .title {
      padding-top: 10px;
      padding-bottom: 14px;
      font-size: 18px;
      line-height: 25px;
      color: #191919;
      text-shadow: 0 1px 1px #FEFFFE;
    }
    .operate {
      position: relative;
      font-size: 14px;
      line-height: 28px;
      font-weight: bold;
      height: 30px;
    }

    .operate ol, .users ol {
      list-style-type: none;
    }

    .operate ol li, .users ol li {
      float: left;
    }

    .operate ol li {
      height: 30px;
      text-align: center;
      cursor: pointer;
      border-radius: 2px;
    }

    .operate ol li.ui-btn {
      width: 32%;
      margin-right: 5%;
    }

    .accept-btn {
      text-shadow: 0 1px 1px #FEFFFE;
      box-shadow: 2px 2px 3px 0.25px rgba(0, 0, 0, 0.25);
      background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#D5E7F0), to(#1F78A5));
      background-image: -webkit-linear-gradient(top, #D5E7F0, #1F78A5);
    }

    .declined-btn {
      color: #E6E6E6;
      text-shadow: 0 -1px 1px rgba(0, 0, 0, 0.33);
      box-shadow: 2px 2px 3px 0.25px rgba(0, 0, 0, 0.25);
      background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#EAEAEA), to(#919191));
      background-image: -webkit-linear-gradient(top, #EAEAEA, #919191);
    }

    .interested-btn {
      color: #7F7F7F;
      text-decoration: underline;
    }

    .operate .opt-btn {
      position: absolute;
      right: 30px;
      top: 0;
      color: #4C4C4C;
      width: 32%;
      height: 26px;
      text-align: center;
      border: 2px solid #1175A5;
      border-radius: 5px;
        display: none;
    }

    .dateplace {
      margin-bottom: 13px;
    }

    .dateplace h2 {
      margin-top: 12px;
      font-size: 18px;
      font-weight: normal;
      line-height: 24px;
      color: #1175A5;
    }

    .date > div {
      height: 15px;
    }

    .date .clock {
      display: inline-block;
      text-indent: 18px;
      font-size: 12px;
      line-height: 18px;
      color: #191919;
      background: url("clock.png") no-repeat left center;
    }

    .date .calendar {
      cursor: pointer;
      vertical-align: middle;
      height: 15px;
      width: 15px;
      display: inline-block;
      background: url("calendar.png") no-repeat left center;
    }

    .place {
      float: left;
      width: 50%;
    }

    .place p {
      font-size: 12px;
      line-height: 18px;
      color: #424242;
    }

    .map {
      margin-top: 20px;
      margin-right: 10px;
      float: right;
      width: 43%;
      height: 75px;
      /*background: #555;*/
    }

    .exfee {
      clear: both;
      overflow: hidden;
    }

    .statistic {
      text-align: right;
    }

    .users {
      width: 82%;
      float: left;
    }

    .users ol li {
      position: relative;
      width: 40px;
      height: 40px;
      margin-right: 1.6%;
      margin-bottom: 1.6%;
    }

    .users ol li img {
      border-radius: 2px;
    }

    .users ol li span {
      display: block;
      position: absolute;
      color: #EAEAEA;
      font-size: 8px;
      font-weight: bold;
      background-color: #1175A5;
      letter-spacing: 1px;
      text-indent: 1px;
    }

    .users ol li span.rt {
      right: 0;
      top: 0;
    }

    .users ol li span.lt {
      left: 0;
      top: 0;
    }

    .users ol li.opacity {
      opacity: 0.4;
      /*-moz-opacity: 0.4;
      filter:alpha(opacity=4);*/
    }

    .statistic {
      float: right;
      font-size: 12px;
      line-height: 12px;
      color: #7F7F7F;
    }

    .statistic .confirmed {
      font-size: 18px;
      line-height: 24px;
      color: #1175A5;
    }

    .description {
      /*border: 1px solid #E5E6E6;*/
      padding-bottom: 10px;
      margin-top: 20px;
      color: #424242;
    }

    .description p {
      /*word-wrap: ;*/
    }
  </style>
</head>

<body>

  <div id="container">
    <!--header>
      <nav>
        <a id="home" href="#Home">Home</a>
        <a id="conversation" href="#Conversation">Conversation</a>
      </nav>
    </header-->
    <div id="main" role="main">
      <section id="cross">
        <h1 class="title">{#title#}</h1>
        
        <div class="operate ">
          <ol id="rsvp_btns" class="clearfix">
            <li class="ui-btn accept-btn" data-rsvp="1" onclick="opt_rsvp(1);">Accept</li>
            <li class="ui-btn declined-btn" data-rsvp="2" onclick="opt_rsvp(2);">Declined</li>
            <li class="interested-btn" data-rsvp="3" onclick="opt_rsvp(3);">Interested</li>
          </ol>
          <div id="change_rsvp" class="opt-btn" onclick="change_rsvp();">Interested</div>
        </div>
        
        <div class="dateplace clearfix">
          <div class="date">
            <h2>{#begin_at_human#}</h2>
            <div>
              <span class="clock">{#begin_at#}</span>
              <a class="calendar" href="#calendar"></a>
            </div>
          </div>
          
          <div class="place">
            <h2>{#place_line1#}</h2>
            <p>{#place_line2#}</p>
          </div>

          <!-- 地图: center=lat,lnt&markers=size:mid%7Ccolor:blue%7Clat,lnt -->
          <div class="map">
            <img src="http://maps.googleapis.com/maps/api/staticmap?center=40.714728,-73.998672&markers=size:mid%7Ccolor:blue%7C40.714728,-73.998672&zoom=8&size=130x75&sensor=false" alt="">
          </div>
        </div>
        
        <div class="exfee">
          <div class="users">
            <ol class="clearfix">
                {#exfee_list#}
              <!--li>
                <img alt="" width="40px" height="40px" src="img/u1.png" />
                <span class="rt">H</span>
              </li>
              <li>
                <img alt="" width="40px" height="40px" src="img/u1.png" />
                <span class="lt">2</span>
              </li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li class="opacity"><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li>
                <img alt="" width="40px" height="40px" src="img/u1.png" />
                <span class="rt">H</span>
              </li>
              <li>
                <img alt="" width="40px" height="40px" src="img/u1.png" />
                <span class="lt">2</span>
              </li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li><img alt="" width="40px" height="40px" src="img/u1.png" /></li>
              <li class="opacity"><img alt="" width="40px" height="40px" src="img/u1.png" /></li-->
            </ol>
          </div>

          <div class="statistic">
            <div>
              <span class="confirmed">4</span>
              /
              <span>7</span>
            </div>
            confirmed
          </div>
        </div>

        <div class="description">
          <p>{#description#}</p>
        </div>
      </section>
    </div>
    <footer>
    </footer>
  </div> <!--! end of #container -->
  <script>
      var NativeBridge = {
          callbacksCount : 1,
          callbacks : {},
          
          // Automatically called by native layer when a result is available
          resultForCallback : function resultForCallback(callbackId, resultArray) {
              try {
                  var callback = NativeBridge.callbacks[callbackId];
                  if (!callback) return;
                  
                  callback.call(null,resultArray);
              } catch(e) {alert(e)}
          },
          
          // Use this in javascript to request native objective-c code
          // functionName : string (I think the name is explicit :p)
          // args : array of arguments
          // callback : function with n-arguments that is going to be called when the native code returned
          call : function call(functionName, args, callback) {
              var hasCallback = callback && typeof callback == "function";
              var callbackId = hasCallback ? NativeBridge.callbacksCount++ : 0;
              
              if (hasCallback)
              NativeBridge.callbacks[callbackId] = callback;
              
              var iframe = document.createElement("IFRAME");
              iframe.setAttribute("src", "js-frame:" + functionName + ":" + callbackId+ ":" + encodeURIComponent(JSON.stringify(args)));
              document.documentElement.appendChild(iframe);
              iframe.parentNode.removeChild(iframe);
              iframe = null;
          }
      };

      function display(id, type) {
          document.getElementById(id).style.display = type === 'hide' ? 'none' : 'block';
      }
      
      function changeHtml(id, content) {
          document.getElementById(id).innerHTML = content;
      }
      
      function change_rsvp() {
          display('change_rsvp', 'hide');
          display('rsvp_btns', 'show');
      }
      
      function opacity(id, type) {
          document.getElementById(id).setAttribute('class', type ? '' : 'opacity');
      }
      
      function opt_rsvp_callback(args) {
          changeHtml('change_rsvp',args.state_str);
          display('rsvp_btns', 'hide');
          display('change_rsvp', 'show');
          opacity("avatar_"+args.identity_id, args.state == 1 ? 1 : 0);
      }
      
        function opt_rsvp (e) {
            NativeBridge.call('rsvp', [e],opt_rsvp_callback);
        }
  </script>
</body>
</html>